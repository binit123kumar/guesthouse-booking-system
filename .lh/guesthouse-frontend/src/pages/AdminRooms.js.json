{
    "sourceFile": "guesthouse-frontend/src/pages/AdminRooms.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1757270523577,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1757271418516,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,34 +5,39 @@\n const AdminRooms = () => {\r\n   const [availableRooms, setAvailableRooms] = useState([]);\r\n \r\n   useEffect(() => {\r\n-    fetch(\"http://localhost:5000/api/bookings\")\r\n-      .then((res) => res.json())\r\n-      .then((data) => {\r\n-        const bookedCount = data.length;\r\n-        const remaining = TOTAL_ROOMS - bookedCount;\r\n+    const fetchData = () => {\r\n+      fetch(\"http://localhost:5000/api/bookings\")\r\n+        .then((res) => res.json())\r\n+        .then((data) => {\r\n+          const today = new Date();\r\n+          // ‚úÖ ‡§∏‡§ø‡§∞‡•ç‡§´‡§º active bookings ‡§ó‡§ø‡§®‡§®‡§æ\r\n+          const activeBookings = data.filter((b) => new Date(b.checkOut || b.checkOutDate) >= today);\r\n+          const bookedCount = activeBookings.reduce((sum, b) => sum + (parseInt(b.roomsRequired) || 1), 0);\r\n+          const remaining = TOTAL_ROOMS - bookedCount;\r\n \r\n-        const roomList = [];\r\n+          const roomList = [];\r\n+          for (let i = 1; i <= remaining; i++) {\r\n+            roomList.push({\r\n+              id: 200 + i,\r\n+              type: i % 3 === 0 ? \"Suite\" : i % 2 === 0 ? \"Double\" : \"Single\",\r\n+              status: \"Available\",\r\n+            });\r\n+          }\r\n+          setAvailableRooms(roomList);\r\n+        })\r\n+        .catch((err) => console.error(\"Error fetching bookings:\", err));\r\n+    };\r\n \r\n-        for (let i = 1; i <= remaining; i++) {\r\n-          roomList.push({\r\n-            id: 200 + i,\r\n-            type: i % 3 === 0 ? \"Suite\" : i % 2 === 0 ? \"Double\" : \"Single\",\r\n-            status: \"Available\",\r\n-          });\r\n-        }\r\n-\r\n-        setAvailableRooms(roomList);\r\n-      })\r\n-      .catch((err) => console.error(\"Error fetching bookings:\", err));\r\n+    fetchData(); // first call\r\n+    const interval = setInterval(fetchData, 30000); // ‡§π‡§∞ 30 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§™‡§∞ refresh\r\n+    return () => clearInterval(interval);\r\n   }, []);\r\n \r\n   return (\r\n     <div style={styles.container}>\r\n-      <h2 style={styles.title}>\r\n-        üõè Available Rooms ({availableRooms.length} / {TOTAL_ROOMS})\r\n-      </h2>\r\n+      <h2 style={styles.title}>üõè Available Rooms ({availableRooms.length} / {TOTAL_ROOMS})</h2>\r\n \r\n       <table style={styles.table}>\r\n         <thead>\r\n           <tr>\r\n@@ -50,11 +55,9 @@\n             </tr>\r\n           ))}\r\n           {availableRooms.length === 0 && (\r\n             <tr>\r\n-              <td style={styles.td} colSpan=\"3\">\r\n-                No rooms available.\r\n-              </td>\r\n+              <td style={styles.td} colSpan=\"3\">No rooms available.</td>\r\n             </tr>\r\n           )}\r\n         </tbody>\r\n       </table>\r\n"
                },
                {
                    "date": 1757873055165,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,16 +3,17 @@\n const TOTAL_ROOMS = 20;\r\n \r\n const AdminRooms = () => {\r\n   const [availableRooms, setAvailableRooms] = useState([]);\r\n+  const [loading, setLoading] = useState(true);\r\n \r\n   useEffect(() => {\r\n     const fetchData = () => {\r\n       fetch(\"http://localhost:5000/api/bookings\")\r\n         .then((res) => res.json())\r\n         .then((data) => {\r\n           const today = new Date();\r\n-          // ‚úÖ ‡§∏‡§ø‡§∞‡•ç‡§´‡§º active bookings ‡§ó‡§ø‡§®‡§®‡§æ\r\n+          // ‚úÖ Count only active bookings\r\n           const activeBookings = data.filter((b) => new Date(b.checkOut || b.checkOutDate) >= today);\r\n           const bookedCount = activeBookings.reduce((sum, b) => sum + (parseInt(b.roomsRequired) || 1), 0);\r\n           const remaining = TOTAL_ROOMS - bookedCount;\r\n \r\n@@ -24,20 +25,28 @@\n               status: \"Available\",\r\n             });\r\n           }\r\n           setAvailableRooms(roomList);\r\n+          setLoading(false);\r\n         })\r\n-        .catch((err) => console.error(\"Error fetching bookings:\", err));\r\n+        .catch((err) => {\r\n+          console.error(\"Error fetching bookings:\", err);\r\n+          setLoading(false);\r\n+        });\r\n     };\r\n \r\n     fetchData(); // first call\r\n-    const interval = setInterval(fetchData, 30000); // ‡§π‡§∞ 30 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§™‡§∞ refresh\r\n+    const interval = setInterval(fetchData, 30000); // refresh every 30 seconds\r\n     return () => clearInterval(interval);\r\n   }, []);\r\n \r\n+  if (loading) {\r\n+    return <div style={styles.container}>Loading rooms...</div>;\r\n+  }\r\n+\r\n   return (\r\n     <div style={styles.container}>\r\n-      <h2 style={styles.title}>üõè Available Rooms ({availableRooms.length} / {TOTAL_ROOMS})</h2>\r\n+      <h2 style={styles.title}>üè® Available Rooms ({TOTAL_ROOMS})</h2>\r\n \r\n       <table style={styles.table}>\r\n         <thead>\r\n           <tr>\r\n@@ -46,16 +55,17 @@\n             <th style={styles.th}>Status</th>\r\n           </tr>\r\n         </thead>\r\n         <tbody>\r\n-          {availableRooms.map((r) => (\r\n-            <tr key={r.id}>\r\n-              <td style={styles.td}>{r.id}</td>\r\n-              <td style={styles.td}>{r.type}</td>\r\n-              <td style={styles.td}>{r.status}</td>\r\n-            </tr>\r\n-          ))}\r\n-          {availableRooms.length === 0 && (\r\n+          {availableRooms.length > 0 ? (\r\n+            availableRooms.map((r) => (\r\n+              <tr key={r.id}>\r\n+                <td style={styles.td}>{r.id}</td>\r\n+                <td style={styles.td}>{r.type}</td>\r\n+                <td style={styles.td}>{r.status}</td>\r\n+              </tr>\r\n+            ))\r\n+          ) : (\r\n             <tr>\r\n               <td style={styles.td} colSpan=\"3\">No rooms available.</td>\r\n             </tr>\r\n           )}\r\n@@ -89,16 +99,14 @@\n     backgroundColor: \"#1cc88a\",\r\n     color: \"#fff\",\r\n     textAlign: \"left\",\r\n     fontWeight: \"bold\",\r\n-    borderBottom: \"1px solid #ddd\",\r\n     fontSize: \"16px\",\r\n   },\r\n   td: {\r\n     padding: \"12px 16px\",\r\n-    borderBottom: \"1px solid #ccc\",\r\n-    fontSize: \"16px\",\r\n-    color: \"#333\",\r\n+    borderBottom: \"1px solid #ddd\",\r\n+    fontSize: \"14px\",\r\n   },\r\n };\r\n \r\n-export default AdminRooms;\r\n+export default AdminRooms;\n\\ No newline at end of file\n"
                }
            ],
            "date": 1757270523577,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\r\n\r\nconst TOTAL_ROOMS = 20;\r\n\r\nconst AdminRooms = () => {\r\n  const [availableRooms, setAvailableRooms] = useState([]);\r\n\r\n  useEffect(() => {\r\n    fetch(\"http://localhost:5000/api/bookings\")\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        const bookedCount = data.length;\r\n        const remaining = TOTAL_ROOMS - bookedCount;\r\n\r\n        const roomList = [];\r\n\r\n        for (let i = 1; i <= remaining; i++) {\r\n          roomList.push({\r\n            id: 200 + i,\r\n            type: i % 3 === 0 ? \"Suite\" : i % 2 === 0 ? \"Double\" : \"Single\",\r\n            status: \"Available\",\r\n          });\r\n        }\r\n\r\n        setAvailableRooms(roomList);\r\n      })\r\n      .catch((err) => console.error(\"Error fetching bookings:\", err));\r\n  }, []);\r\n\r\n  return (\r\n    <div style={styles.container}>\r\n      <h2 style={styles.title}>\r\n        üõè Available Rooms ({availableRooms.length} / {TOTAL_ROOMS})\r\n      </h2>\r\n\r\n      <table style={styles.table}>\r\n        <thead>\r\n          <tr>\r\n            <th style={styles.th}>Room No</th>\r\n            <th style={styles.th}>Type</th>\r\n            <th style={styles.th}>Status</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {availableRooms.map((r) => (\r\n            <tr key={r.id}>\r\n              <td style={styles.td}>{r.id}</td>\r\n              <td style={styles.td}>{r.type}</td>\r\n              <td style={styles.td}>{r.status}</td>\r\n            </tr>\r\n          ))}\r\n          {availableRooms.length === 0 && (\r\n            <tr>\r\n              <td style={styles.td} colSpan=\"3\">\r\n                No rooms available.\r\n              </td>\r\n            </tr>\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst styles = {\r\n  container: {\r\n    padding: \"40px\",\r\n    background: \"#f8f9fc\",\r\n    minHeight: \"100vh\",\r\n    fontFamily: \"Segoe UI, sans-serif\",\r\n  },\r\n  title: {\r\n    fontSize: \"28px\",\r\n    marginBottom: \"20px\",\r\n    textAlign: \"center\",\r\n    color: \"#333\",\r\n  },\r\n  table: {\r\n    width: \"100%\",\r\n    borderCollapse: \"collapse\",\r\n    background: \"#fff\",\r\n    boxShadow: \"0 4px 8px rgba(0,0,0,0.1)\",\r\n  },\r\n  th: {\r\n    padding: \"12px 16px\",\r\n    backgroundColor: \"#1cc88a\",\r\n    color: \"#fff\",\r\n    textAlign: \"left\",\r\n    fontWeight: \"bold\",\r\n    borderBottom: \"1px solid #ddd\",\r\n    fontSize: \"16px\",\r\n  },\r\n  td: {\r\n    padding: \"12px 16px\",\r\n    borderBottom: \"1px solid #ccc\",\r\n    fontSize: \"16px\",\r\n    color: \"#333\",\r\n  },\r\n};\r\n\r\nexport default AdminRooms;\r\n"
        }
    ]
}