{
    "sourceFile": "guesthouse-frontend/src/pages/AdminPendingBookings.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1758513759175,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1758513759175,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\r\n\r\nconst AdminPendingBookings = () => {\r\n  const [pendingBookings, setPendingBookings] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [declineReason, setDeclineReason] = useState({});\r\n\r\n  const fetchPendingBookings = () => {\r\n    setLoading(true);\r\n    fetch(\"http://localhost:5000/api/bookings/pending\")\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        setPendingBookings(data);\r\n        setLoading(false);\r\n      })\r\n      .catch((err) => {\r\n        console.error(\"Error fetching pending bookings:\", err);\r\n        setLoading(false);\r\n        setMessage(\"Error fetching data.\");\r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchPendingBookings();\r\n  }, []);\r\n\r\n  const handleApprove = (booking) => {\r\n    const roomNumber = prompt(\"Please enter the room number to assign:\");\r\n    if (!roomNumber) return;\r\n\r\n    fetch(\"http://localhost:5000/api/bookings/approve\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ tempId: booking.tempId, roomNumber }),\r\n    })\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        setMessage(data.message);\r\n        fetchPendingBookings(); // Refresh the list\r\n      })\r\n      .catch((err) => {\r\n        console.error(\"Error approving booking:\", err);\r\n        setMessage(\"Error approving booking.\");\r\n      });\r\n  };\r\n\r\n  const handleDecline = (booking) => {\r\n    const reason = declineReason[booking.tempId];\r\n    if (!reason) {\r\n        alert(\"Please provide a reason for declining.\");\r\n        return;\r\n    }\r\n\r\n    fetch(\"http://localhost:5000/api/bookings/decline\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ tempId: booking.tempId, reason }),\r\n    })\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        setMessage(data.message);\r\n        fetchPendingBookings(); // Refresh the list\r\n      })\r\n      .catch((err) => {\r\n        console.error(\"Error declining booking:\", err);\r\n        setMessage(\"Error declining booking.\");\r\n      });\r\n  };\r\n\r\n  if (loading) {\r\n    return <div style={styles.container}>Loading pending requests...</div>;\r\n  }\r\n\r\n  return (\r\n    <div style={styles.container}>\r\n      <h2 style={styles.title}>‚è≥ Pending Booking Requests</h2>\r\n      {message && <p style={styles.message}>{message}</p>}\r\n      \r\n      {pendingBookings.length === 0 ? (\r\n        <p style={styles.noRequests}>No pending booking requests at this time.</p>\r\n      ) : (\r\n        <div style={styles.cardContainer}>\r\n          {pendingBookings.map((booking) => (\r\n            <div key={booking.tempId} style={styles.bookingCard}>\r\n              <h3>{booking.fullName}</h3>\r\n              <p><strong>Room Type:</strong> {booking.roomType}</p>\r\n              <p><strong>Dates:</strong> {booking.checkInDate} to {booking.checkOutDate}</p>\r\n              <p><strong>Rooms:</strong> {booking.roomsRequired}</p>\r\n              <p><strong>Contact:</strong> {booking.email}</p>\r\n\r\n              <div style={styles.declineSection}>\r\n                  <textarea\r\n                    placeholder=\"Reason for decline\"\r\n                    value={declineReason[booking.tempId] || \"\"}\r\n                    onChange={(e) => setDeclineReason({ ...declineReason, [booking.tempId]: e.target.value })}\r\n                    style={styles.declineInput}\r\n                  />\r\n                  <button onClick={() => handleDecline(booking)} style={styles.declineBtn}>Decline</button>\r\n              </div>\r\n              \r\n              <button onClick={() => handleApprove(booking)} style={styles.approveBtn}>Approve</button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst styles = {\r\n    container: {\r\n        padding: \"40px\",\r\n        background: \"#f8f9fc\",\r\n        minHeight: \"100vh\",\r\n        fontFamily: \"Segoe UI, sans-serif\",\r\n    },\r\n    title: {\r\n        fontSize: \"28px\",\r\n        marginBottom: \"20px\",\r\n        textAlign: \"center\",\r\n        color: \"#333\",\r\n    },\r\n    message: {\r\n        textAlign: \"center\",\r\n        color: \"#4CAF50\",\r\n        fontWeight: \"bold\",\r\n    },\r\n    noRequests: {\r\n        textAlign: \"center\",\r\n        color: \"#666\",\r\n        fontSize: \"18px\",\r\n    },\r\n    cardContainer: {\r\n        display: \"grid\",\r\n        gridTemplateColumns: \"repeat(auto-fit, minmax(300px, 1fr))\",\r\n        gap: \"20px\",\r\n    },\r\n    bookingCard: {\r\n        background: \"#fff\",\r\n        padding: \"25px\",\r\n        borderRadius: \"10px\",\r\n        boxShadow: \"0 4px 12px rgba(0,0,0,0.1)\",\r\n        borderLeft: \"5px solid #f6c23e\",\r\n    },\r\n    declineSection: {\r\n        marginTop: \"15px\",\r\n        marginBottom: \"10px\",\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        gap: \"8px\",\r\n    },\r\n    declineInput: {\r\n      width: \"95%\",\r\n      padding: \"8px\",\r\n      borderRadius: \"5px\",\r\n      border: \"1px solid #ccc\",\r\n    },\r\n    approveBtn: {\r\n        width: \"100%\",\r\n        padding: \"12px\",\r\n        fontSize: \"16px\",\r\n        backgroundColor: \"#28a745\",\r\n        color: \"white\",\r\n        border: \"none\",\r\n        borderRadius: \"5px\",\r\n        cursor: \"pointer\",\r\n        transition: \"background-color 0.2s\",\r\n        marginTop: \"10px\",\r\n    },\r\n    declineBtn: {\r\n        width: \"100%\",\r\n        padding: \"12px\",\r\n        fontSize: \"16px\",\r\n        backgroundColor: \"#dc3545\",\r\n        color: \"white\",\r\n        border: \"none\",\r\n        borderRadius: \"5px\",\r\n        cursor: \"pointer\",\r\n        transition: \"background-color 0.2s\",\r\n    },\r\n};\r\n\r\nexport default AdminPendingBookings;"
        }
    ]
}