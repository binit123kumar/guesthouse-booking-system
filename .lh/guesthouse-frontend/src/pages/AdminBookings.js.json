{
    "sourceFile": "guesthouse-frontend/src/pages/AdminBookings.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1757270692991,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1757271741453,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,12 +3,18 @@\n const AdminBookings = () => {\r\n   const [bookings, setBookings] = useState([]);\r\n \r\n   useEffect(() => {\r\n-    fetch(\"http://localhost:5000/api/bookings\")\r\n-      .then((res) => res.json())\r\n-      .then((data) => setBookings(data))\r\n-      .catch((err) => console.error(\"Error fetching bookings:\", err));\r\n+    const fetchData = () => {\r\n+      fetch(\"http://localhost:5000/api/bookings\")\r\n+        .then((res) => res.json())\r\n+        .then((data) => setBookings(data))\r\n+        .catch((err) => console.error(\"Error fetching bookings:\", err));\r\n+    };\r\n+\r\n+    fetchData(); // à¤ªà¤¹à¤²à¤¾ call\r\n+    const interval = setInterval(fetchData, 30000); // à¤¹à¤° 30 à¤¸à¥‡à¤•à¤‚à¤¡ à¤ªà¤° refresh\r\n+    return () => clearInterval(interval);\r\n   }, []);\r\n \r\n   const downloadInvoice = (index) => {\r\n     window.open(`http://localhost:5000/api/bookings/${index}/invoice`, \"_blank\");\r\n"
                },
                {
                    "date": 1758513836078,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,68 +1,92 @@\n import React, { useEffect, useState } from \"react\";\r\n \r\n const AdminBookings = () => {\r\n   const [bookings, setBookings] = useState([]);\r\n+  const [loading, setLoading] = useState(true);\r\n \r\n   useEffect(() => {\r\n     const fetchData = () => {\r\n       fetch(\"http://localhost:5000/api/bookings\")\r\n         .then((res) => res.json())\r\n-        .then((data) => setBookings(data))\r\n-        .catch((err) => console.error(\"Error fetching bookings:\", err));\r\n+        .then((data) => {\r\n+          setBookings(data);\r\n+          setLoading(false);\r\n+        })\r\n+        .catch((err) => {\r\n+          console.error(\"Error fetching bookings:\", err);\r\n+          setLoading(false);\r\n+        });\r\n     };\r\n \r\n-    fetchData(); // à¤ªà¤¹à¤²à¤¾ call\r\n-    const interval = setInterval(fetchData, 30000); // à¤¹à¤° 30 à¤¸à¥‡à¤•à¤‚à¤¡ à¤ªà¤° refresh\r\n-    return () => clearInterval(interval);\r\n+    fetchData(); \r\n+    const interval = setInterval(fetchData, 30000); \r\n+    return () => clearInterval(interval); \r\n   }, []);\r\n \r\n-  const downloadInvoice = (index) => {\r\n-    window.open(`http://localhost:5000/api/bookings/${index}/invoice`, \"_blank\");\r\n+  const downloadInvoice = (bookingId) => {\r\n+    // This assumes the backend uses a proper ID, not an array index\r\n+    window.open(`http://localhost:5000/api/bookings/${bookingId}/invoice`, \"_blank\");\r\n   };\r\n \r\n+  const getStatusStyle = (status) => {\r\n+    switch (status) {\r\n+      case \"approved\":\r\n+        return { color: \"green\", fontWeight: \"bold\" };\r\n+      case \"declined\":\r\n+        return { color: \"red\", fontWeight: \"bold\" };\r\n+      case \"pending\":\r\n+      default:\r\n+        return { color: \"orange\", fontWeight: \"bold\" };\r\n+    }\r\n+  };\r\n+\r\n+  if (loading) {\r\n+    return <div style={styles.container}>Loading bookings...</div>;\r\n+  }\r\n+\r\n   return (\r\n     <div style={styles.container}>\r\n-      <h2 style={styles.title}>ðŸ“‹ Total Bookings</h2>\r\n-\r\n+      <h2 style={styles.title}>ðŸ“‹ All Bookings</h2>\r\n+      \r\n       <table style={styles.table}>\r\n         <thead>\r\n           <tr>\r\n-            <th style={styles.th}>#</th>\r\n+            <th style={styles.th}>Temp ID</th>\r\n+            <th style={styles.th}>Booking ID</th>\r\n             <th style={styles.th}>Name</th>\r\n             <th style={styles.th}>Room Type</th>\r\n             <th style={styles.th}>Check-In</th>\r\n             <th style={styles.th}>Check-Out</th>\r\n-            <th style={styles.th}>Payment</th>\r\n-            <th style={styles.th}>Amount</th>\r\n+            <th style={styles.th}>Status</th>\r\n+            <th style={styles.th}>Decline Reason</th>\r\n             <th style={styles.th}>Invoice</th>\r\n           </tr>\r\n         </thead>\r\n         <tbody>\r\n-          {bookings.map((b, i) => {\r\n-            const checkIn = b.checkIn || b.checkInDate || \"-\";\r\n-            const checkOut = b.checkOut || b.checkOutDate || \"-\";\r\n-\r\n-            return (\r\n-              <tr key={i}>\r\n-                <td style={styles.td}>{i + 1}</td>\r\n+          {bookings.length > 0 ? (\r\n+            bookings.map((b, i) => (\r\n+              <tr key={b.tempId || i}>\r\n+                <td style={styles.td}>{b.tempId}</td>\r\n+                <td style={styles.td}>{b.bookingId || \"N/A\"}</td>\r\n                 <td style={styles.td}>{b.fullName}</td>\r\n                 <td style={styles.td}>{b.roomType}</td>\r\n-                <td style={styles.td}>{checkIn}</td>\r\n-                <td style={styles.td}>{checkOut}</td>\r\n-                <td style={styles.td}>{b.paymentStatus || \"-\"}</td>\r\n-                <td style={styles.td}>â‚¹ {b.amount || 0}</td>\r\n+                <td style={styles.td}>{b.checkInDate}</td>\r\n+                <td style={styles.td}>{b.checkOutDate}</td>\r\n+                <td style={{ ...styles.td, ...getStatusStyle(b.status) }}>{b.status}</td>\r\n+                <td style={styles.td}>{b.declineReason || \"N/A\"}</td>\r\n                 <td style={styles.td}>\r\n-                  <button style={styles.invoiceBtn} onClick={() => downloadInvoice(i)}>\r\n-                    Download\r\n-                  </button>\r\n+                  {b.status === \"approved\" && (\r\n+                      <button style={styles.invoiceBtn} onClick={() => downloadInvoice(b.bookingId)}>\r\n+                          Invoice\r\n+                      </button>\r\n+                  )}\r\n                 </td>\r\n               </tr>\r\n-            );\r\n-          })}\r\n-          {bookings.length === 0 && (\r\n+            ))\r\n+          ) : (\r\n             <tr>\r\n-              <td style={styles.td} colSpan=\"8\">No bookings found.</td>\r\n+              <td style={styles.td} colSpan=\"9\">No bookings found.</td>\r\n             </tr>\r\n           )}\r\n         </tbody>\r\n       </table>\r\n@@ -94,24 +118,23 @@\n     backgroundColor: \"#4e73df\",\r\n     color: \"#fff\",\r\n     textAlign: \"left\",\r\n     fontWeight: \"bold\",\r\n-    fontSize: \"16px\",\r\n-    borderBottom: \"1px solid #ddd\",\r\n+    fontSize: \"14px\",\r\n+    textTransform: \"uppercase\",\r\n   },\r\n   td: {\r\n     padding: \"12px 16px\",\r\n-    borderBottom: \"1px solid #ccc\",\r\n-    fontSize: \"16px\",\r\n-    color: \"#333\",\r\n+    borderBottom: \"1px solid #ddd\",\r\n+    fontSize: \"14px\",\r\n   },\r\n   invoiceBtn: {\r\n-    padding: \"6px 12px\",\r\n-    backgroundColor: \"#28a745\",\r\n+    padding: \"8px 12px\",\r\n+    backgroundColor: \"#17a2b8\",\r\n+    color: \"white\",\r\n     border: \"none\",\r\n-    borderRadius: \"6px\",\r\n-    color: \"#fff\",\r\n+    borderRadius: \"5px\",\r\n     cursor: \"pointer\",\r\n   },\r\n };\r\n \r\n-export default AdminBookings;\r\n+export default AdminBookings;\n\\ No newline at end of file\n"
                }
            ],
            "date": 1757270692990,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\r\n\r\nconst AdminBookings = () => {\r\n  const [bookings, setBookings] = useState([]);\r\n\r\n  useEffect(() => {\r\n    fetch(\"http://localhost:5000/api/bookings\")\r\n      .then((res) => res.json())\r\n      .then((data) => setBookings(data))\r\n      .catch((err) => console.error(\"Error fetching bookings:\", err));\r\n  }, []);\r\n\r\n  const downloadInvoice = (index) => {\r\n    window.open(`http://localhost:5000/api/bookings/${index}/invoice`, \"_blank\");\r\n  };\r\n\r\n  return (\r\n    <div style={styles.container}>\r\n      <h2 style={styles.title}>ðŸ“‹ Total Bookings</h2>\r\n\r\n      <table style={styles.table}>\r\n        <thead>\r\n          <tr>\r\n            <th style={styles.th}>#</th>\r\n            <th style={styles.th}>Name</th>\r\n            <th style={styles.th}>Room Type</th>\r\n            <th style={styles.th}>Check-In</th>\r\n            <th style={styles.th}>Check-Out</th>\r\n            <th style={styles.th}>Payment</th>\r\n            <th style={styles.th}>Amount</th>\r\n            <th style={styles.th}>Invoice</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {bookings.map((b, i) => {\r\n            const checkIn = b.checkIn || b.checkInDate || \"-\";\r\n            const checkOut = b.checkOut || b.checkOutDate || \"-\";\r\n\r\n            return (\r\n              <tr key={i}>\r\n                <td style={styles.td}>{i + 1}</td>\r\n                <td style={styles.td}>{b.fullName}</td>\r\n                <td style={styles.td}>{b.roomType}</td>\r\n                <td style={styles.td}>{checkIn}</td>\r\n                <td style={styles.td}>{checkOut}</td>\r\n                <td style={styles.td}>{b.paymentStatus || \"-\"}</td>\r\n                <td style={styles.td}>â‚¹ {b.amount || 0}</td>\r\n                <td style={styles.td}>\r\n                  <button style={styles.invoiceBtn} onClick={() => downloadInvoice(i)}>\r\n                    Download\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n          {bookings.length === 0 && (\r\n            <tr>\r\n              <td style={styles.td} colSpan=\"8\">No bookings found.</td>\r\n            </tr>\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst styles = {\r\n  container: {\r\n    padding: \"40px\",\r\n    background: \"#f8f9fc\",\r\n    minHeight: \"100vh\",\r\n    fontFamily: \"Segoe UI, sans-serif\",\r\n  },\r\n  title: {\r\n    fontSize: \"28px\",\r\n    marginBottom: \"20px\",\r\n    textAlign: \"center\",\r\n    color: \"#333\",\r\n  },\r\n  table: {\r\n    width: \"100%\",\r\n    borderCollapse: \"collapse\",\r\n    background: \"#fff\",\r\n    boxShadow: \"0 4px 8px rgba(0,0,0,0.1)\",\r\n  },\r\n  th: {\r\n    padding: \"12px 16px\",\r\n    backgroundColor: \"#4e73df\",\r\n    color: \"#fff\",\r\n    textAlign: \"left\",\r\n    fontWeight: \"bold\",\r\n    fontSize: \"16px\",\r\n    borderBottom: \"1px solid #ddd\",\r\n  },\r\n  td: {\r\n    padding: \"12px 16px\",\r\n    borderBottom: \"1px solid #ccc\",\r\n    fontSize: \"16px\",\r\n    color: \"#333\",\r\n  },\r\n  invoiceBtn: {\r\n    padding: \"6px 12px\",\r\n    backgroundColor: \"#28a745\",\r\n    border: \"none\",\r\n    borderRadius: \"6px\",\r\n    color: \"#fff\",\r\n    cursor: \"pointer\",\r\n  },\r\n};\r\n\r\nexport default AdminBookings;\r\n"
        }
    ]
}